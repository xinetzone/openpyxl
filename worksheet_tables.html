
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Worksheet Tables &#8212; openpyxl 3.0.9 文档</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/translations.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="Parsing Formulas" href="formula.html" />
    <link rel="prev" title="Defined Names" href="defined_names.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="formula.html" title="Parsing Formulas"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="defined_names.html" title="Defined Names"
             accesskey="P">上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">openpyxl 3.0.9 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Worksheet Tables</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="worksheet-tables">
<h1>Worksheet Tables<a class="headerlink" href="#worksheet-tables" title="永久链接至标题">¶</a></h1>
<p>Worksheet tables are references to groups of cells. This makes
certain operations such as styling the cells in a table easier.</p>
<section id="creating-a-table">
<h2>Creating a table<a class="headerlink" href="#creating-a-table" title="永久链接至标题">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="kn">from</span> <span class="nn">openpyxl.worksheet.table</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">TableStyleInfo</span>

<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Apples&#39;</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">6000</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Pears&#39;</span><span class="p">,</span>   <span class="mi">2000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Bananas&#39;</span><span class="p">,</span> <span class="mi">6000</span><span class="p">,</span> <span class="mi">6000</span><span class="p">,</span> <span class="mi">6500</span><span class="p">,</span> <span class="mi">6000</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Oranges&#39;</span><span class="p">,</span>  <span class="mi">500</span><span class="p">,</span>  <span class="mi">300</span><span class="p">,</span>  <span class="mi">200</span><span class="p">,</span>  <span class="mi">700</span><span class="p">],</span>
<span class="p">]</span>

<span class="c1"># add column headings. NB. these must be strings</span>
<span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;Fruit&quot;</span><span class="p">,</span> <span class="s2">&quot;2011&quot;</span><span class="p">,</span> <span class="s2">&quot;2012&quot;</span><span class="p">,</span> <span class="s2">&quot;2013&quot;</span><span class="p">,</span> <span class="s2">&quot;2014&quot;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

<span class="n">tab</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">displayName</span><span class="o">=</span><span class="s2">&quot;Table1&quot;</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="s2">&quot;A1:E5&quot;</span><span class="p">)</span>

<span class="c1"># Add a default style with striped rows and banded columns</span>
<span class="n">style</span> <span class="o">=</span> <span class="n">TableStyleInfo</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;TableStyleMedium9&quot;</span><span class="p">,</span> <span class="n">showFirstColumn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">showLastColumn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showRowStripes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showColumnStripes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tab</span><span class="o">.</span><span class="n">tableStyleInfo</span> <span class="o">=</span> <span class="n">style</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Table must be added using ws.add_table() method to avoid duplicate names.</span>
<span class="sd">Using this method ensures table name is unque through out defined names and all other table name. </span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="n">ws</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;table.xlsx&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Table names must be unique within a workbook. By default tables are created with a header from the first row and filters for all the columns and table headers and column headings must always contain strings.</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>In write-only mode you must add column headings to tables manually and the values must always be the same as the values of the corresponding cells (ee below for an example of how to do this), otherwise Excel may consider the file invalid and remove the table.</p>
</div>
<p>Styles are managed using the the <cite>TableStyleInfo</cite> object. This allows you to
stripe rows or columns and apply the different colour schemes.</p>
</section>
<section id="working-with-tables">
<h2>Working with Tables<a class="headerlink" href="#working-with-tables" title="永久链接至标题">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ws.tables</span></code> is a dictionary-like object of all the tables in a particular worksheet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span><span class="o">.</span><span class="n">tables</span>
<span class="go">{&quot;Table1&quot;,  &lt;openpyxl.worksheet.table.Table object&gt;}</span>
</pre></div>
</div>
<section id="get-table-by-name-or-range">
<h3>Get Table by name or range<a class="headerlink" href="#get-table-by-name-or-range" title="永久链接至标题">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s2">&quot;Table1&quot;</span><span class="p">]</span>
<span class="go">or</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s2">&quot;A1:D10&quot;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="iterate-through-all-tables-in-a-worksheet">
<h3>Iterate through all tables in a worksheet<a class="headerlink" href="#iterate-through-all-tables-in-a-worksheet" title="永久链接至标题">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">tables</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="get-table-name-and-range-of-all-tables-in-a-worksheet">
<h3>Get table name and range of all tables in a worksheet<a class="headerlink" href="#get-table-name-and-range-of-all-tables-in-a-worksheet" title="永久链接至标题">¶</a></h3>
<p>Returns a list of table name and their ranges.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span><span class="o">.</span><span class="n">tables</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="s2">&quot;Table1&quot;</span><span class="p">,</span> <span class="s2">&quot;A1:D10&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</section>
<section id="delete-a-table">
<h3>Delete a table<a class="headerlink" href="#delete-a-table" title="永久链接至标题">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">ws</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s2">&quot;Table1&quot;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="the-number-of-tables-in-a-worksheet">
<h3>The number of tables in a worksheet<a class="headerlink" href="#the-number-of-tables-in-a-worksheet" title="永久链接至标题">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">1</span>
</pre></div>
</div>
</section>
</section>
<section id="manually-adding-column-headings">
<h2>Manually adding column headings<a class="headerlink" href="#manually-adding-column-headings" title="永久链接至标题">¶</a></h2>
<p>In write-only mode you can either only add tables without headings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">headerRowCount</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<p>Or initialise the column headings manually:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Fruit&quot;</span><span class="p">,</span> <span class="s2">&quot;2011&quot;</span><span class="p">,</span> <span class="s2">&quot;2012&quot;</span><span class="p">,</span> <span class="s2">&quot;2013&quot;</span><span class="p">,</span> <span class="s2">&quot;2014&quot;</span><span class="p">]</span> <span class="c1"># all values must be strings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">_initialise_columns</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">tableColumns</span><span class="p">,</span> <span class="n">headings</span><span class="p">):</span>
<span class="go">    column.name = value</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="index.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">Worksheet Tables</a><ul>
<li><a class="reference internal" href="#creating-a-table">Creating a table</a></li>
<li><a class="reference internal" href="#working-with-tables">Working with Tables</a><ul>
<li><a class="reference internal" href="#get-table-by-name-or-range">Get Table by name or range</a></li>
<li><a class="reference internal" href="#iterate-through-all-tables-in-a-worksheet">Iterate through all tables in a worksheet</a></li>
<li><a class="reference internal" href="#get-table-name-and-range-of-all-tables-in-a-worksheet">Get table name and range of all tables in a worksheet</a></li>
<li><a class="reference internal" href="#delete-a-table">Delete a table</a></li>
<li><a class="reference internal" href="#the-number-of-tables-in-a-worksheet">The number of tables in a worksheet</a></li>
</ul>
</li>
<li><a class="reference internal" href="#manually-adding-column-headings">Manually adding column headings</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一个主题</h4>
    <p class="topless"><a href="defined_names.html"
                          title="上一章">Defined Names</a></p>
  </div>
  <div>
    <h4>下一个主题</h4>
    <p class="topless"><a href="formula.html"
                          title="下一章">Parsing Formulas</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/worksheet_tables.rst.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="formula.html" title="Parsing Formulas"
             >下一页</a> |</li>
        <li class="right" >
          <a href="defined_names.html" title="Defined Names"
             >上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">openpyxl 3.0.9 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Worksheet Tables</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; 版权所有 2010 - 2022, See AUTHORS.
      由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0创建。
    </div>
  </body>
</html>