
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Pivot Tables &#8212; openpyxl 3.0.9 文档</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/translations.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="Print Settings" href="print_settings.html" />
    <link rel="prev" title="Conditional Formatting" href="formatting.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="print_settings.html" title="Print Settings"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="formatting.html" title="Conditional Formatting"
             accesskey="P">上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">openpyxl 3.0.9 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Pivot Tables</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="pivot-tables">
<h1>Pivot Tables<a class="headerlink" href="#pivot-tables" title="永久链接至标题">¶</a></h1>
<p>openpyxl provides read-support for pivot tables so that they will be
preserved in existing files. The specification for pivot tables, while
extensive, is not very clear and it is not intended that client code should
be able to create pivot tables. However, it should be possible to edit and
manipulate existing pivot tables, eg. change their ranges or whether they
should update automatically settings.</p>
<p>As is the case for charts, images and tables there is currently no management
API for pivot tables so that client code will have to loop over the
<code class="docutils literal notranslate"><span class="pre">_pivots</span></code> list of a worksheet.</p>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="永久链接至标题">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">load_workbook</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s2">&quot;campaign.xlsx&quot;</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s2">&quot;Results&quot;</span><span class="p">]</span>
<span class="n">pivot</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">_pivots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># any will do as they share the same cache</span>
<span class="n">pivot</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">refreshOnLoad</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>For further information see <a class="reference internal" href="api/openpyxl.pivot.cache.html#openpyxl.pivot.cache.CacheDefinition" title="openpyxl.pivot.cache.CacheDefinition"><code class="xref py py-class docutils literal notranslate"><span class="pre">openpyxl.pivot.cache.CacheDefinition</span></code></a></p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="index.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">Pivot Tables</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一个主题</h4>
    <p class="topless"><a href="formatting.html"
                          title="上一章">Conditional Formatting</a></p>
  </div>
  <div>
    <h4>下一个主题</h4>
    <p class="topless"><a href="print_settings.html"
                          title="下一章">Print Settings</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pivot.rst.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="print_settings.html" title="Print Settings"
             >下一页</a> |</li>
        <li class="right" >
          <a href="formatting.html" title="Conditional Formatting"
             >上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">openpyxl 3.0.9 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Pivot Tables</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; 版权所有 2010 - 2022, See AUTHORS.
      由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0创建。
    </div>
  </body>
</html>