
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Performance &#8212; openpyxl 3.0.9 文档</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/translations.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="Optimised Modes" href="optimized.html" />
    <link rel="prev" title="Simple usage" href="usage.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="optimized.html" title="Optimised Modes"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="usage.html" title="Simple usage"
             accesskey="P">上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">openpyxl 3.0.9 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Performance</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="performance">
<h1>Performance<a class="headerlink" href="#performance" title="永久链接至标题">¶</a></h1>
<p>openpyxl attempts to balance functionality and performance. Where in doubt,
we have focused on functionality over optimisation: performance tweaks are
easier once an API has been established. Memory use is fairly high in
comparison with other libraries and applications and is approximately 50
times the original file size, e.g. 2.5 GB for a 50 MB Excel file. As many use
cases involve either only reading or writing files, the <a class="reference internal" href="optimized.html"><span class="doc">Optimised Modes</span></a>
modes mean this is less of a problem.</p>
<section id="benchmarks">
<h2>Benchmarks<a class="headerlink" href="#benchmarks" title="永久链接至标题">¶</a></h2>
<p>All benchmarks are synthetic and extremely dependent upon the hardware but
they can nevertheless give an indication.</p>
<section id="write-performance">
<h3>Write Performance<a class="headerlink" href="#write-performance" title="永久链接至标题">¶</a></h3>
<p>The <a class="reference external" href="https://foss.heptapod.net/openpyxl/openpyxl/-/snippets/66">benchmark code</a>
can be adjusted to use more sheets and adjust the proportion of data that is
strings. Because the version of Python being used can also significantly
affect performance, a <a class="reference external" href="https://foss.heptapod.net/openpyxl/openpyxl/-/snippets/67">driver script</a>
can also be used to test with different Python versions with a tox
environment.</p>
<p>Performance is compared with the excellent alternative library xlsxwriter</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Versions</span><span class="p">:</span>
<span class="n">python</span><span class="p">:</span> <span class="mf">3.6.9</span>
<span class="n">openpyxl</span><span class="p">:</span> <span class="mf">3.0.1</span>
<span class="n">xlsxwriter</span><span class="p">:</span> <span class="mf">1.2.5</span>

<span class="n">Dimensions</span><span class="p">:</span>
    <span class="n">Rows</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">Cols</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">Sheets</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">Proportion</span> <span class="n">text</span> <span class="o">=</span> <span class="mf">0.10</span>

<span class="n">Times</span><span class="p">:</span>
    <span class="n">xlsxwriter</span>            <span class="p">:</span>   <span class="mf">0.59</span>
    <span class="n">xlsxwriter</span> <span class="p">(</span><span class="n">optimised</span><span class="p">):</span>   <span class="mf">0.54</span>
    <span class="n">openpyxl</span>              <span class="p">:</span>   <span class="mf">0.73</span>
    <span class="n">openpyxl</span> <span class="p">(</span><span class="n">optimised</span><span class="p">)</span>  <span class="p">:</span>   <span class="mf">0.61</span>


<span class="n">Versions</span><span class="p">:</span>
<span class="n">python</span><span class="p">:</span> <span class="mf">3.7.5</span>
<span class="n">openpyxl</span><span class="p">:</span> <span class="mf">3.0.1</span>
<span class="n">xlsxwriter</span><span class="p">:</span> <span class="mf">1.2.5</span>

<span class="n">Dimensions</span><span class="p">:</span>
    <span class="n">Rows</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">Cols</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">Sheets</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">Proportion</span> <span class="n">text</span> <span class="o">=</span> <span class="mf">0.10</span>

<span class="n">Times</span><span class="p">:</span>
    <span class="n">xlsxwriter</span>            <span class="p">:</span>   <span class="mf">0.65</span>
    <span class="n">xlsxwriter</span> <span class="p">(</span><span class="n">optimised</span><span class="p">):</span>   <span class="mf">0.53</span>
    <span class="n">openpyxl</span>              <span class="p">:</span>   <span class="mf">0.70</span>
    <span class="n">openpyxl</span> <span class="p">(</span><span class="n">optimised</span><span class="p">)</span>  <span class="p">:</span>   <span class="mf">0.63</span>


<span class="n">Versions</span><span class="p">:</span>
<span class="n">python</span><span class="p">:</span> <span class="mf">3.8.0</span>
<span class="n">openpyxl</span><span class="p">:</span> <span class="mf">3.0.1</span>
<span class="n">xlsxwriter</span><span class="p">:</span> <span class="mf">1.2.5</span>

<span class="n">Dimensions</span><span class="p">:</span>
    <span class="n">Rows</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">Cols</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">Sheets</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">Proportion</span> <span class="n">text</span> <span class="o">=</span> <span class="mf">0.10</span>

<span class="n">Times</span><span class="p">:</span>
    <span class="n">xlsxwriter</span>            <span class="p">:</span>   <span class="mf">0.54</span>
    <span class="n">xlsxwriter</span> <span class="p">(</span><span class="n">optimised</span><span class="p">):</span>   <span class="mf">0.50</span>
    <span class="n">openpyxl</span>              <span class="p">:</span>   <span class="mf">1.10</span>
    <span class="n">openpyxl</span> <span class="p">(</span><span class="n">optimised</span><span class="p">)</span>  <span class="p">:</span>   <span class="mf">0.57</span>
</pre></div>
</div>
</section>
<section id="read-performance">
<h3>Read Performance<a class="headerlink" href="#read-performance" title="永久链接至标题">¶</a></h3>
<p>Performance is measured using a file provided with a previous <a class="reference external" href="https://bitbucket.org/openpyxl/openpyxl/issues/494/">bug report</a> and compared with the
older xlrd library. xlrd is primarily for the older BIFF file format of .XLS
files but it does have limited support for XLSX.</p>
<p>The code for the <a class="reference external" href="https://foss.heptapod.net/openpyxl/openpyxl/-/snippets/68">benchmark</a> shows the importance of
choosing the right options when working with a file. In this case disabling
external links stops openpyxl opening cached copies of the linked worksheets.</p>
<p>One major difference between the libraries is that openpyxl’s read-only mode
opens a workbook almost immediately making it suitable for multiple
processes, this also readuces memory use significantly. xlrd does also not
automatically convert dates and times into Python datetimes, though it does
annotate cells accordingly but to do this in client code significantly
reduces performance.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Versions</span><span class="p">:</span>
<span class="n">python</span><span class="p">:</span> <span class="mf">3.6.9</span>
<span class="n">xlread</span><span class="p">:</span> <span class="mf">1.2.0</span>
<span class="n">openpyxl</span><span class="p">:</span> <span class="mf">3.0.1</span>

<span class="n">openpyxl</span><span class="p">,</span> <span class="n">read</span><span class="o">-</span><span class="n">only</span>
    <span class="n">Workbook</span> <span class="n">loaded</span> <span class="mf">1.14</span><span class="n">s</span>
    <span class="n">OptimizationData</span> <span class="mf">23.17</span><span class="n">s</span>
    <span class="n">Output</span> <span class="n">Model</span> <span class="mf">0.00</span><span class="n">s</span>
    <span class="o">&gt;&gt;</span><span class="n">DATA</span><span class="o">&gt;&gt;</span> <span class="mf">0.00</span><span class="n">s</span>
    <span class="n">Store</span> <span class="n">days</span> <span class="mi">0</span><span class="o">%</span> <span class="mf">23.92</span><span class="n">s</span>
    <span class="n">Store</span> <span class="n">days</span> <span class="mi">100</span><span class="o">%</span> <span class="mf">17.35</span><span class="n">s</span>
    <span class="n">Total</span> <span class="n">time</span> <span class="mf">65.59</span><span class="n">s</span>
    <span class="mi">0</span> <span class="n">cells</span> <span class="ow">in</span> <span class="n">total</span>

<span class="n">Versions</span><span class="p">:</span>
<span class="n">python</span><span class="p">:</span> <span class="mf">3.7.5</span>
<span class="n">xlread</span><span class="p">:</span> <span class="mf">1.2.0</span>
<span class="n">openpyxl</span><span class="p">:</span> <span class="mf">3.0.1</span>

<span class="n">openpyxl</span><span class="p">,</span> <span class="n">read</span><span class="o">-</span><span class="n">only</span>
    <span class="n">Workbook</span> <span class="n">loaded</span> <span class="mf">0.98</span><span class="n">s</span>
    <span class="n">OptimizationData</span> <span class="mf">21.35</span><span class="n">s</span>
    <span class="n">Output</span> <span class="n">Model</span> <span class="mf">0.00</span><span class="n">s</span>
    <span class="o">&gt;&gt;</span><span class="n">DATA</span><span class="o">&gt;&gt;</span> <span class="mf">0.00</span><span class="n">s</span>
    <span class="n">Store</span> <span class="n">days</span> <span class="mi">0</span><span class="o">%</span> <span class="mf">20.70</span><span class="n">s</span>
    <span class="n">Store</span> <span class="n">days</span> <span class="mi">100</span><span class="o">%</span> <span class="mf">16.16</span><span class="n">s</span>
    <span class="n">Total</span> <span class="n">time</span> <span class="mf">59.19</span><span class="n">s</span>
    <span class="mi">0</span> <span class="n">cells</span> <span class="ow">in</span> <span class="n">total</span>

<span class="n">Versions</span><span class="p">:</span>
<span class="n">python</span><span class="p">:</span> <span class="mf">3.8.0</span>
<span class="n">xlread</span><span class="p">:</span> <span class="mf">1.2.0</span>
<span class="n">openpyxl</span><span class="p">:</span> <span class="mf">3.0.1</span>

<span class="n">openpyxl</span><span class="p">,</span> <span class="n">read</span><span class="o">-</span><span class="n">only</span>
    <span class="n">Workbook</span> <span class="n">loaded</span> <span class="mf">0.90</span><span class="n">s</span>
    <span class="n">OptimizationData</span> <span class="mf">19.58</span><span class="n">s</span>
    <span class="n">Output</span> <span class="n">Model</span> <span class="mf">0.00</span><span class="n">s</span>
    <span class="o">&gt;&gt;</span><span class="n">DATA</span><span class="o">&gt;&gt;</span> <span class="mf">0.00</span><span class="n">s</span>
    <span class="n">Store</span> <span class="n">days</span> <span class="mi">0</span><span class="o">%</span> <span class="mf">19.35</span><span class="n">s</span>
    <span class="n">Store</span> <span class="n">days</span> <span class="mi">100</span><span class="o">%</span> <span class="mf">15.02</span><span class="n">s</span>
    <span class="n">Total</span> <span class="n">time</span> <span class="mf">54.85</span><span class="n">s</span>
    <span class="mi">0</span> <span class="n">cells</span> <span class="ow">in</span> <span class="n">total</span>
</pre></div>
</div>
</section>
<section id="parallelisation">
<h3>Parallelisation<a class="headerlink" href="#parallelisation" title="永久链接至标题">¶</a></h3>
<p>Reading worksheets is fairly CPU-intensive which limits any benefits to be
gained by parallelisation. However, if you are mainly interested in dumping
the contents of a workbook then you can use openpyxl’s read-only mode and
open multiple instances of a workbook and take advantage of multiple CPUs.</p>
<p><a class="reference external" href="https://foss.heptapod.net/openpyxl/openpyxl/-/snippets/69">Sample code</a> using the
same source file as for read performance shows that performance scales
reasonably with only a slight overhead due to creating additional Python
processes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Parallised</span> <span class="n">Read</span>
    <span class="n">Workbook</span> <span class="n">loaded</span> <span class="mf">1.12</span><span class="n">s</span>
    <span class="o">&gt;&gt;</span><span class="n">DATA</span><span class="o">&gt;&gt;</span> <span class="mf">2.27</span><span class="n">s</span>
    <span class="n">Output</span> <span class="n">Model</span> <span class="mf">2.30</span><span class="n">s</span>
    <span class="n">Store</span> <span class="n">days</span> <span class="mi">100</span><span class="o">%</span> <span class="mf">37.18</span><span class="n">s</span>
    <span class="n">OptimizationData</span> <span class="mf">44.09</span><span class="n">s</span>
    <span class="n">Store</span> <span class="n">days</span> <span class="mi">0</span><span class="o">%</span> <span class="mf">45.60</span><span class="n">s</span>
    <span class="n">Total</span> <span class="n">time</span> <span class="mf">46.76</span><span class="n">s</span>
</pre></div>
</div>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="index.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">Performance</a><ul>
<li><a class="reference internal" href="#benchmarks">Benchmarks</a><ul>
<li><a class="reference internal" href="#write-performance">Write Performance</a></li>
<li><a class="reference internal" href="#read-performance">Read Performance</a></li>
<li><a class="reference internal" href="#parallelisation">Parallelisation</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一个主题</h4>
    <p class="topless"><a href="usage.html"
                          title="上一章">Simple usage</a></p>
  </div>
  <div>
    <h4>下一个主题</h4>
    <p class="topless"><a href="optimized.html"
                          title="下一章">Optimised Modes</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/performance.rst.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="optimized.html" title="Optimised Modes"
             >下一页</a> |</li>
        <li class="right" >
          <a href="usage.html" title="Simple usage"
             >上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">openpyxl 3.0.9 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Performance</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; 版权所有 2010 - 2022, See AUTHORS.
      由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0创建。
    </div>
  </body>
</html>