
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Line Charts &#8212; openpyxl 3.0.9 文档</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nature.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="Scatter Charts" href="scatter.html" />
    <link rel="prev" title="Bubble Charts" href="bubble.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="scatter.html" title="Scatter Charts"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="bubble.html" title="Bubble Charts"
             accesskey="P">上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">openpyxl 3.0.9 文档</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="introduction.html" accesskey="U">Charts</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Line Charts</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="line-charts">
<h1>Line Charts<a class="headerlink" href="#line-charts" title="永久链接至标题">¶</a></h1>
<section id="id1">
<h2>Line Charts<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h2>
<p>Line charts allow data to be plotted against a fixed axis. They are similar
to scatter charts, the main difference is that with line charts each data
series is plotted against the same values. Different kinds of axes can be
used for the secondary axes.</p>
<p>Similar to bar charts there are three kinds of line charts: standard, stacked
and percentStacked.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>

<span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="kn">from</span> <span class="nn">openpyxl.chart</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">LineChart</span><span class="p">,</span>
    <span class="n">Reference</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">openpyxl.chart.axis</span> <span class="kn">import</span> <span class="n">DateAxis</span>

<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>

<span class="n">rows</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
    <span class="p">[</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="p">[</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span>
    <span class="p">[</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
    <span class="p">[</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="p">[</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">35</span><span class="p">],</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
    <span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

<span class="n">c1</span> <span class="o">=</span> <span class="n">LineChart</span><span class="p">()</span>
<span class="n">c1</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Line Chart&quot;</span>
<span class="n">c1</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="mi">13</span>
<span class="n">c1</span><span class="o">.</span><span class="n">y_axis</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Size&#39;</span>
<span class="n">c1</span><span class="o">.</span><span class="n">x_axis</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Test Number&#39;</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">Reference</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">min_col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">c1</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">titles_from_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Style the lines</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">s1</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">symbol</span> <span class="o">=</span> <span class="s2">&quot;triangle&quot;</span>
<span class="n">s1</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">graphicalProperties</span><span class="o">.</span><span class="n">solidFill</span> <span class="o">=</span> <span class="s2">&quot;FF0000&quot;</span> <span class="c1"># Marker filling</span>
<span class="n">s1</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">graphicalProperties</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">solidFill</span> <span class="o">=</span> <span class="s2">&quot;FF0000&quot;</span> <span class="c1"># Marker outline</span>

<span class="n">s1</span><span class="o">.</span><span class="n">graphicalProperties</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">noFill</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">s2</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">s2</span><span class="o">.</span><span class="n">graphicalProperties</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">solidFill</span> <span class="o">=</span> <span class="s2">&quot;00AAAA&quot;</span>
<span class="n">s2</span><span class="o">.</span><span class="n">graphicalProperties</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">dashStyle</span> <span class="o">=</span> <span class="s2">&quot;sysDot&quot;</span>
<span class="n">s2</span><span class="o">.</span><span class="n">graphicalProperties</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">100050</span> <span class="c1"># width in EMUs</span>

<span class="n">s2</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">s2</span><span class="o">.</span><span class="n">smooth</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># Make the line smooth</span>

<span class="n">ws</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="s2">&quot;A10&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="n">stacked</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
<span class="n">stacked</span><span class="o">.</span><span class="n">grouping</span> <span class="o">=</span> <span class="s2">&quot;stacked&quot;</span>
<span class="n">stacked</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Stacked Line Chart&quot;</span>
<span class="n">ws</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span><span class="n">stacked</span><span class="p">,</span> <span class="s2">&quot;A27&quot;</span><span class="p">)</span>

<span class="n">percent_stacked</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
<span class="n">percent_stacked</span><span class="o">.</span><span class="n">grouping</span> <span class="o">=</span> <span class="s2">&quot;percentStacked&quot;</span>
<span class="n">percent_stacked</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Percent Stacked Line Chart&quot;</span>
<span class="n">ws</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span><span class="n">percent_stacked</span><span class="p">,</span> <span class="s2">&quot;A44&quot;</span><span class="p">)</span>

<span class="c1"># Chart with date axis</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">LineChart</span><span class="p">()</span>
<span class="n">c2</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Date Axis&quot;</span>
<span class="n">c2</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">c2</span><span class="o">.</span><span class="n">y_axis</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Size&quot;</span>
<span class="n">c2</span><span class="o">.</span><span class="n">y_axis</span><span class="o">.</span><span class="n">crossAx</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">c2</span><span class="o">.</span><span class="n">x_axis</span> <span class="o">=</span> <span class="n">DateAxis</span><span class="p">(</span><span class="n">crossAx</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">c2</span><span class="o">.</span><span class="n">x_axis</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;d-mmm&#39;</span>
<span class="n">c2</span><span class="o">.</span><span class="n">x_axis</span><span class="o">.</span><span class="n">majorTimeUnit</span> <span class="o">=</span> <span class="s2">&quot;days&quot;</span>
<span class="n">c2</span><span class="o">.</span><span class="n">x_axis</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Date&quot;</span>

<span class="n">c2</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">titles_from_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">Reference</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">min_col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">c2</span><span class="o">.</span><span class="n">set_categories</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>

<span class="n">ws</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="s2">&quot;A61&quot;</span><span class="p">)</span>

<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;line.xlsx&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="&quot;Sample line charts&quot;" src="../_images/line.png" />
</section>
<section id="d-line-charts">
<h2>3D Line Charts<a class="headerlink" href="#d-line-charts" title="永久链接至标题">¶</a></h2>
<p>In 3D line charts the third axis is the same as the legend for the series.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>

<span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="kn">from</span> <span class="nn">openpyxl.chart</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">LineChart3D</span><span class="p">,</span>
    <span class="n">Reference</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">openpyxl.chart.axis</span> <span class="kn">import</span> <span class="n">DateAxis</span>

<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>

<span class="n">rows</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
    <span class="p">[</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="p">[</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span>
    <span class="p">[</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
    <span class="p">[</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="p">[</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">35</span><span class="p">],</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
    <span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

<span class="n">c1</span> <span class="o">=</span> <span class="n">LineChart3D</span><span class="p">()</span>
<span class="n">c1</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;3D Line Chart&quot;</span>
<span class="n">c1</span><span class="o">.</span><span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">c1</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">c1</span><span class="o">.</span><span class="n">y_axis</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Size&#39;</span>
<span class="n">c1</span><span class="o">.</span><span class="n">x_axis</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Test Number&#39;</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">Reference</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">min_col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">c1</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">titles_from_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ws</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="s2">&quot;A10&quot;</span><span class="p">)</span>

<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;line3D.xlsx&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="&quot;Sample 3D line chart&quot;" src="../_images/line3D.png" />
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="../index.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">Line Charts</a><ul>
<li><a class="reference internal" href="#id1">Line Charts</a></li>
<li><a class="reference internal" href="#d-line-charts">3D Line Charts</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一个主题</h4>
    <p class="topless"><a href="bubble.html"
                          title="上一章">Bubble Charts</a></p>
  </div>
  <div>
    <h4>下一个主题</h4>
    <p class="topless"><a href="scatter.html"
                          title="下一章">Scatter Charts</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/charts/line.rst.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="scatter.html" title="Scatter Charts"
             >下一页</a> |</li>
        <li class="right" >
          <a href="bubble.html" title="Bubble Charts"
             >上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">openpyxl 3.0.9 文档</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="introduction.html" >Charts</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Line Charts</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; 版权所有 2010 - 2022, See AUTHORS.
      由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0创建。
    </div>
  </body>
</html>