
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Inserting and deleting rows and columns, moving ranges of cells &#8212; openpyxl 3.0.9 文档</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/translations.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="Working with Pandas and NumPy" href="pandas.html" />
    <link rel="prev" title="Optimised Modes" href="optimized.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="pandas.html" title="Working with Pandas and NumPy"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="optimized.html" title="Optimised Modes"
             accesskey="P">上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">openpyxl 3.0.9 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Inserting and deleting rows and columns, moving ranges of cells</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="inserting-and-deleting-rows-and-columns-moving-ranges-of-cells">
<h1>Inserting and deleting rows and columns, moving ranges of cells<a class="headerlink" href="#inserting-and-deleting-rows-and-columns-moving-ranges-of-cells" title="永久链接至标题">¶</a></h1>
<section id="inserting-rows-and-columns">
<h2>Inserting rows and columns<a class="headerlink" href="#inserting-rows-and-columns" title="永久链接至标题">¶</a></h2>
<p>You can insert rows or columns using the relevant worksheet methods:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="api/openpyxl.worksheet.worksheet.html#openpyxl.worksheet.worksheet.Worksheet.insert_rows" title="openpyxl.worksheet.worksheet.Worksheet.insert_rows"><code class="xref py py-func docutils literal notranslate"><span class="pre">openpyxl.worksheet.worksheet.Worksheet.insert_rows()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/openpyxl.worksheet.worksheet.html#openpyxl.worksheet.worksheet.Worksheet.insert_cols" title="openpyxl.worksheet.worksheet.Worksheet.insert_cols"><code class="xref py py-func docutils literal notranslate"><span class="pre">openpyxl.worksheet.worksheet.Worksheet.insert_cols()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/openpyxl.worksheet.worksheet.html#openpyxl.worksheet.worksheet.Worksheet.delete_rows" title="openpyxl.worksheet.worksheet.Worksheet.delete_rows"><code class="xref py py-func docutils literal notranslate"><span class="pre">openpyxl.worksheet.worksheet.Worksheet.delete_rows()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/openpyxl.worksheet.worksheet.html#openpyxl.worksheet.worksheet.Worksheet.delete_cols" title="openpyxl.worksheet.worksheet.Worksheet.delete_cols"><code class="xref py py-func docutils literal notranslate"><span class="pre">openpyxl.worksheet.worksheet.Worksheet.delete_cols()</span></code></a></p></li>
</ul>
</div></blockquote>
<p>The default is one row or column. For example to insert a row at 7 (before
the existing row 7):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span><span class="o">.</span><span class="n">insert_rows</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="deleting-rows-and-columns">
<h2>Deleting rows and columns<a class="headerlink" href="#deleting-rows-and-columns" title="永久链接至标题">¶</a></h2>
<p>To delete the columns <code class="docutils literal notranslate"><span class="pre">F:H</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span><span class="o">.</span><span class="n">delete_cols</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Openpyxl does not manage dependencies, such as formulae, tables, charts,
etc., when rows or columns are inserted or deleted. This is considered to
be out of scope for a library that focuses on managing the file format.
As a result, client code <strong>must</strong> implement the functionality required in
any particular use case.</p>
</div>
</section>
<section id="moving-ranges-of-cells">
<h2>Moving ranges of cells<a class="headerlink" href="#moving-ranges-of-cells" title="永久链接至标题">¶</a></h2>
<p>You can also move ranges of cells within a worksheet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span><span class="o">.</span><span class="n">move_range</span><span class="p">(</span><span class="s2">&quot;D4:F10&quot;</span><span class="p">,</span> <span class="n">rows</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>This will move the cells in the range <code class="docutils literal notranslate"><span class="pre">D4:F10</span></code> up one row, and right two
columns. The cells will overwrite any existing cells.</p>
<p>If cells contain formulae you can let openpyxl translate these for you, but
as this is not always what you want it is disabled by default. Also only the
formulae in the cells themselves will be translated. References to the cells
from other cells or defined names will not be updated; you can use the
<a class="reference internal" href="formula.html"><span class="doc">Parsing Formulas</span></a> translator to do this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span><span class="o">.</span><span class="n">move_range</span><span class="p">(</span><span class="s2">&quot;G4:H10&quot;</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>This will move the relative references in formulae in the range by one row and one column.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="index.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">Inserting and deleting rows and columns, moving ranges of cells</a><ul>
<li><a class="reference internal" href="#inserting-rows-and-columns">Inserting rows and columns</a></li>
<li><a class="reference internal" href="#deleting-rows-and-columns">Deleting rows and columns</a></li>
<li><a class="reference internal" href="#moving-ranges-of-cells">Moving ranges of cells</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一个主题</h4>
    <p class="topless"><a href="optimized.html"
                          title="上一章">Optimised Modes</a></p>
  </div>
  <div>
    <h4>下一个主题</h4>
    <p class="topless"><a href="pandas.html"
                          title="下一章">Working with Pandas and NumPy</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/editing_worksheets.rst.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="pandas.html" title="Working with Pandas and NumPy"
             >下一页</a> |</li>
        <li class="right" >
          <a href="optimized.html" title="Optimised Modes"
             >上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">openpyxl 3.0.9 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Inserting and deleting rows and columns, moving ranges of cells</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; 版权所有 2010 - 2022, See AUTHORS.
      由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0创建。
    </div>
  </body>
</html>