
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Tutorial &#8212; openpyxl 3.0.9 文档</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/translations.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="Simple usage" href="usage.html" />
    <link rel="prev" title="openpyxl - A Python library to read/write Excel 2010 xlsx/xlsm files" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="usage.html" title="Simple usage"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="index.html" title="openpyxl - A Python library to read/write Excel 2010 xlsx/xlsm files"
             accesskey="P">上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">openpyxl 3.0.9 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Tutorial</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="永久链接至标题">¶</a></h1>
<section id="create-a-workbook">
<h2>Create a workbook<a class="headerlink" href="#create-a-workbook" title="永久链接至标题">¶</a></h2>
<p>There is no need to create a file on the filesystem to get started with openpyxl.
Just import the <code class="xref py py-class docutils literal notranslate"><span class="pre">Workbook</span></code> class and start work:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
</pre></div>
</div>
<p>A workbook is always created with at least one worksheet. You can get it by
using the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Workbook.active</span></code> property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>This is set to 0 by default. Unless you modify its value, you will always
get the first worksheet by using this method.</p>
</div>
<p>You can create new worksheets using the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Workbook.create_sheet()</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws1</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">&quot;Mysheet&quot;</span><span class="p">)</span> <span class="c1"># insert at the end (default)</span>
<span class="go"># or</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ws2</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">&quot;Mysheet&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># insert at first position</span>
<span class="go"># or</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ws3</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">&quot;Mysheet&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># insert at the penultimate position</span>
</pre></div>
</div>
<p>Sheets are given a name automatically when they are created.
They are numbered in sequence (Sheet, Sheet1, Sheet2, …).
You can change this name at any time with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Worksheet.title</span></code> property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;New Title&quot;</span>
</pre></div>
</div>
<p>The background color of the tab holding this title is white by default.
You can change this providing an <code class="code docutils literal notranslate"><span class="pre">RRGGBB</span></code> color code to the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Worksheet.sheet_properties.tabColor</span></code> attribute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span><span class="o">.</span><span class="n">sheet_properties</span><span class="o">.</span><span class="n">tabColor</span> <span class="o">=</span> <span class="s2">&quot;1072BA&quot;</span>
</pre></div>
</div>
<p>Once you gave a worksheet a name, you can get it as a key of the workbook:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws3</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s2">&quot;New Title&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>You can review the names of all worksheets of the workbook with the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Workbook.sheetname</span></code> attribute</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">wb</span><span class="o">.</span><span class="n">sheetnames</span><span class="p">)</span>
<span class="go">[&#39;Sheet2&#39;, &#39;New Title&#39;, &#39;Sheet1&#39;]</span>
</pre></div>
</div>
<p>You can loop through worksheets</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">sheet</span> <span class="ow">in</span> <span class="n">wb</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
<p>You can create copies of worksheets <strong>within a single workbook</strong>:</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Workbook.copy_worksheet()</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">copy_worksheet</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Only cells (including values, styles, hyperlinks and comments) and
certain worksheet attribues (including dimensions, format and
properties) are copied. All other workbook / worksheet attributes
are not copied - e.g. Images, Charts.</p>
<p>You also <strong>cannot</strong> copy worksheets between workbooks. You cannot copy
a worksheet if the workbook is open in <cite>read-only</cite> or <cite>write-only</cite>
mode.</p>
</div>
</section>
<section id="playing-with-data">
<h2>Playing with data<a class="headerlink" href="#playing-with-data" title="永久链接至标题">¶</a></h2>
<section id="accessing-one-cell">
<h3>Accessing one cell<a class="headerlink" href="#accessing-one-cell" title="永久链接至标题">¶</a></h3>
<p>Now we know how to get a worksheet, we can start modifying cells content.
Cells can be accessed directly as keys of the worksheet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A4&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>This will return the cell at A4, or create one if it does not exist yet.
Values can be directly assigned:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
<p>There is also the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Worksheet.cell()</span></code> method.</p>
<p>This provides access to cells using row and column notation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>When a worksheet is created in memory, it contains no <cite>cells</cite>. They are
created when first accessed.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>Because of this feature, scrolling through cells instead of accessing them
directly will create them all in memory, even if you don’t assign them a value.</p>
<p>Something like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">):</span>
<span class="gp">... </span>       <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">):</span>
<span class="gp">... </span>           <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>will create 100x100 cells in memory, for nothing.</p>
</div>
</section>
<section id="accessing-many-cells">
<h3>Accessing many cells<a class="headerlink" href="#accessing-many-cells" title="永久链接至标题">¶</a></h3>
<p>Ranges of cells can be accessed using slicing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cell_range</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">:</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Ranges of rows or columns can be obtained similarly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">colC</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col_range</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;C:D&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row10</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row_range</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<p>You can also use the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Worksheet.iter_rows()</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
<span class="gp">... </span>       <span class="nb">print</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
<span class="go">&lt;Cell Sheet1.A1&gt;</span>
<span class="go">&lt;Cell Sheet1.B1&gt;</span>
<span class="go">&lt;Cell Sheet1.C1&gt;</span>
<span class="go">&lt;Cell Sheet1.A2&gt;</span>
<span class="go">&lt;Cell Sheet1.B2&gt;</span>
<span class="go">&lt;Cell Sheet1.C2&gt;</span>
</pre></div>
</div>
<p>Likewise the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Worksheet.iter_cols()</span></code> method will return columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">iter_cols</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
<span class="go">&lt;Cell Sheet1.A1&gt;</span>
<span class="go">&lt;Cell Sheet1.A2&gt;</span>
<span class="go">&lt;Cell Sheet1.B1&gt;</span>
<span class="go">&lt;Cell Sheet1.B2&gt;</span>
<span class="go">&lt;Cell Sheet1.C1&gt;</span>
<span class="go">&lt;Cell Sheet1.C2&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>For performance reasons the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Worksheet.iter_cols()</span></code> method is not available in read-only mode.</p>
</div>
<p>If you need to iterate through all the rows or columns of a file, you can instead use the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Worksheet.rows</span></code> property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span><span class="p">[</span><span class="s1">&#39;C9&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hello world&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">tuple</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>
<span class="go">((&lt;Cell Sheet.A1&gt;, &lt;Cell Sheet.B1&gt;, &lt;Cell Sheet.C1&gt;),</span>
<span class="go">(&lt;Cell Sheet.A2&gt;, &lt;Cell Sheet.B2&gt;, &lt;Cell Sheet.C2&gt;),</span>
<span class="go">(&lt;Cell Sheet.A3&gt;, &lt;Cell Sheet.B3&gt;, &lt;Cell Sheet.C3&gt;),</span>
<span class="go">(&lt;Cell Sheet.A4&gt;, &lt;Cell Sheet.B4&gt;, &lt;Cell Sheet.C4&gt;),</span>
<span class="go">(&lt;Cell Sheet.A5&gt;, &lt;Cell Sheet.B5&gt;, &lt;Cell Sheet.C5&gt;),</span>
<span class="go">(&lt;Cell Sheet.A6&gt;, &lt;Cell Sheet.B6&gt;, &lt;Cell Sheet.C6&gt;),</span>
<span class="go">(&lt;Cell Sheet.A7&gt;, &lt;Cell Sheet.B7&gt;, &lt;Cell Sheet.C7&gt;),</span>
<span class="go">(&lt;Cell Sheet.A8&gt;, &lt;Cell Sheet.B8&gt;, &lt;Cell Sheet.C8&gt;),</span>
<span class="go">(&lt;Cell Sheet.A9&gt;, &lt;Cell Sheet.B9&gt;, &lt;Cell Sheet.C9&gt;))</span>
</pre></div>
</div>
<p>or the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Worksheet.columns</span></code> property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">tuple</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="go">((&lt;Cell Sheet.A1&gt;,</span>
<span class="go">&lt;Cell Sheet.A2&gt;,</span>
<span class="go">&lt;Cell Sheet.A3&gt;,</span>
<span class="go">&lt;Cell Sheet.A4&gt;,</span>
<span class="go">&lt;Cell Sheet.A5&gt;,</span>
<span class="go">&lt;Cell Sheet.A6&gt;,</span>
<span class="gp">...</span>
<span class="go">&lt;Cell Sheet.B7&gt;,</span>
<span class="go">&lt;Cell Sheet.B8&gt;,</span>
<span class="go">&lt;Cell Sheet.B9&gt;),</span>
<span class="go">(&lt;Cell Sheet.C1&gt;,</span>
<span class="go">&lt;Cell Sheet.C2&gt;,</span>
<span class="go">&lt;Cell Sheet.C3&gt;,</span>
<span class="go">&lt;Cell Sheet.C4&gt;,</span>
<span class="go">&lt;Cell Sheet.C5&gt;,</span>
<span class="go">&lt;Cell Sheet.C6&gt;,</span>
<span class="go">&lt;Cell Sheet.C7&gt;,</span>
<span class="go">&lt;Cell Sheet.C8&gt;,</span>
<span class="go">&lt;Cell Sheet.C9&gt;))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>For performance reasons the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Worksheet.columns</span></code> property is not available in read-only mode.</p>
</div>
</section>
<section id="values-only">
<h3>Values only<a class="headerlink" href="#values-only" title="永久链接至标题">¶</a></h3>
<p>If you just want the values from a worksheet you can use the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Worksheet.values</span></code> property.
This iterates over all the rows in a worksheet but returns just the cell values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
   <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
     <span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>Both <code class="xref py py-meth docutils literal notranslate"><span class="pre">Worksheet.iter_rows()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Worksheet.iter_cols()</span></code> can
take the <code class="code docutils literal notranslate"><span class="pre">values_only</span></code> parameter to return just the cell’s value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">values_only</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

<span class="go">(None, None, None)</span>
<span class="go">(None, None, None)</span>
</pre></div>
</div>
</section>
</section>
<section id="data-storage">
<h2>Data storage<a class="headerlink" href="#data-storage" title="永久链接至标题">¶</a></h2>
<p>Once we have a <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code>, we can assign it a value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;hello, world&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="go">&#39;hello, world&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">3.14</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="go">3.14</span>
</pre></div>
</div>
<section id="saving-to-a-file">
<h3>Saving to a file<a class="headerlink" href="#saving-to-a-file" title="永久链接至标题">¶</a></h3>
<p>The simplest and safest way to save a workbook is by using the
<code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook.save()</span></code> method of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Workbook</span></code> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;balances.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>This operation will overwrite existing files without warning.</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>The filename extension is not forced to be xlsx or xlsm, although you might have
some trouble opening it directly with another application if you don’t
use an official extension.</p>
<p>As OOXML files are basically ZIP files, you can also  open it with your
favourite ZIP archive manager.</p>
</div>
</section>
<section id="saving-as-a-stream">
<h3>Saving as a stream<a class="headerlink" href="#saving-as-a-stream" title="永久链接至标题">¶</a></h3>
<p>If you want to save the file to a stream, e.g. when using a web application
such as Pyramid, Flask or Django then you can simply provide a
<code class="xref py py-func docutils literal notranslate"><span class="pre">NamedTemporaryFile()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">NamedTemporaryFile</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmp</span><span class="p">:</span>
<span class="go">        wb.save(tmp.name)</span>
<span class="go">        tmp.seek(0)</span>
<span class="go">        stream = tmp.read()</span>
</pre></div>
</div>
<p>You can specify the attribute <cite>template=True</cite>, to save a workbook
as a template:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;document.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;document_template.xltx&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>or set this attribute to <cite>False</cite> (default), to save as a document:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;document_template.xltx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;document.xlsx&#39;</span><span class="p">,</span> <span class="n">as_template</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>You should monitor the data attributes and document extensions
for saving documents in the document templates and vice versa,
otherwise the result table engine can not open the document.</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>The following will fail:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;document.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Need to save with the extension *.xlsx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;new_document.xlsm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># MS Excel can&#39;t open the document</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Need specify attribute keep_vba=True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;document.xlsm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;new_document.xlsm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># MS Excel will not open the document</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;document.xltm&#39;</span><span class="p">,</span> <span class="n">keep_vba</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># If we need a template document, then we must specify extension as *.xltm.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;new_document.xlsm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># MS Excel will not open the document</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="loading-from-a-file">
<h2>Loading from a file<a class="headerlink" href="#loading-from-a-file" title="永久链接至标题">¶</a></h2>
<p>The same way as writing, you can use the <code class="xref py py-func docutils literal notranslate"><span class="pre">openpyxl.load_workbook()</span></code> to
open an existing workbook:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">load_workbook</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb2</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;test.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">wb2</span><span class="o">.</span><span class="n">sheetnames</span><span class="p">)</span>
<span class="go">[&#39;Sheet2&#39;, &#39;New Title&#39;, &#39;Sheet1&#39;]</span>
</pre></div>
</div>
<p>This ends the tutorial for now, you can proceed to the <a class="reference internal" href="usage.html"><span class="doc">Simple usage</span></a> section</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="index.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">Tutorial</a><ul>
<li><a class="reference internal" href="#create-a-workbook">Create a workbook</a></li>
<li><a class="reference internal" href="#playing-with-data">Playing with data</a><ul>
<li><a class="reference internal" href="#accessing-one-cell">Accessing one cell</a></li>
<li><a class="reference internal" href="#accessing-many-cells">Accessing many cells</a></li>
<li><a class="reference internal" href="#values-only">Values only</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-storage">Data storage</a><ul>
<li><a class="reference internal" href="#saving-to-a-file">Saving to a file</a></li>
<li><a class="reference internal" href="#saving-as-a-stream">Saving as a stream</a></li>
</ul>
</li>
<li><a class="reference internal" href="#loading-from-a-file">Loading from a file</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一个主题</h4>
    <p class="topless"><a href="index.html"
                          title="上一章">openpyxl - A Python library to read/write Excel 2010 xlsx/xlsm files</a></p>
  </div>
  <div>
    <h4>下一个主题</h4>
    <p class="topless"><a href="usage.html"
                          title="下一章">Simple usage</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tutorial.rst.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="usage.html" title="Simple usage"
             >下一页</a> |</li>
        <li class="right" >
          <a href="index.html" title="openpyxl - A Python library to read/write Excel 2010 xlsx/xlsm files"
             >上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">openpyxl 3.0.9 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Tutorial</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; 版权所有 2010 - 2022, See AUTHORS.
      由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0创建。
    </div>
  </body>
</html>