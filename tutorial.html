
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>教程 &#8212; openpyxl 3.0.9 文档</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/translations.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="简单用法" href="usage.html" />
    <link rel="prev" title="openpyxl - A Python library to read/write Excel 2010 xlsx/xlsm files" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="usage.html" title="简单用法"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="index.html" title="openpyxl - A Python library to read/write Excel 2010 xlsx/xlsm files"
             accesskey="P">上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">openpyxl 3.0.9 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">教程</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="tutorial">
<h1>教程<a class="headerlink" href="#tutorial" title="永久链接至标题">¶</a></h1>
<section id="create-a-workbook">
<h2>创建工作簿<a class="headerlink" href="#create-a-workbook" title="永久链接至标题">¶</a></h2>
<p>开始使用 openpyxl 时，不需要在文件系统上创建文件。只要导入 <code class="xref py py-class docutils literal notranslate"><span class="pre">Workbook</span></code> 类，然后开始工作</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
</pre></div>
</div>
<p>工作簿总是由至少一个工作表创建。你可以使用 <code class="xref py py-obj docutils literal notranslate"><span class="pre">Workbook.active</span></code> 属性获得它:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>默认设置为 0。除非你修改了它的值，否则你总是会使用这个方法得到第一个工作表。</p>
</div>
<p>您可以使用 <code class="xref py py-meth docutils literal notranslate"><span class="pre">Workbook.create_sheet()</span></code> 方法创建新的工作表:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws1</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">&quot;Mysheet&quot;</span><span class="p">)</span> <span class="c1"># insert at the end (default)</span>
<span class="go"># or</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ws2</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">&quot;Mysheet&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># insert at first position</span>
<span class="go"># or</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ws3</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">&quot;Mysheet&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># insert at the penultimate position</span>
</pre></div>
</div>
<p>表在创建时自动指定名称。它们按顺序编号 (Sheet, Sheet1, Sheet2, …)。你可以在任何时候用 <code class="xref py py-obj docutils literal notranslate"><span class="pre">Worksheet.title</span></code> 属性修改命名:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;New Title&quot;</span>
</pre></div>
</div>
<p>默认情况下，包含该标题的标签的背景颜色为白色。你可以将 <code class="code docutils literal notranslate"><span class="pre">RRGGBB</span></code> 颜色代码改为 <code class="xref py py-obj docutils literal notranslate"><span class="pre">Worksheet.sheet_properties.tabColor</span></code> 属性:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span><span class="o">.</span><span class="n">sheet_properties</span><span class="o">.</span><span class="n">tabColor</span> <span class="o">=</span> <span class="s2">&quot;1072BA&quot;</span>
</pre></div>
</div>
<p>一旦你给工作表一个名字，你可以得到它作为工作簿的键</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws3</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s2">&quot;New Title&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>你可以使用 <code class="xref py py-obj docutils literal notranslate"><span class="pre">Workbook.sheetname</span></code> 属性来查看工作簿中所有工作表的名称</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">wb</span><span class="o">.</span><span class="n">sheetnames</span><span class="p">)</span>
<span class="go">[&#39;Sheet2&#39;, &#39;New Title&#39;, &#39;Sheet1&#39;]</span>
</pre></div>
</div>
<p>你可以循环工作表</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">sheet</span> <span class="ow">in</span> <span class="n">wb</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
<p>您可以在 <strong>单个工作簿</strong> 中创建工作表的副本：</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Workbook.copy_worksheet()</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">copy_worksheet</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>只复制单元格（包括值、样式、超链接和注释）和某些工作表属性（包括尺寸、格式和属性）。所有其他工作簿/工作表属性不被复制——例如图像，图表。</p>
<p>您也不能在工作簿之间复制工作表。如果工作簿以 <cite>read-only</cite> 或 <cite>write-only</cite> 模式打开，则无法复制工作表。</p>
</div>
</section>
<section id="playing-with-data">
<h2>玩数据<a class="headerlink" href="#playing-with-data" title="永久链接至标题">¶</a></h2>
<section id="accessing-one-cell">
<h3>访问一个单元格<a class="headerlink" href="#accessing-one-cell" title="永久链接至标题">¶</a></h3>
<p>现在我们知道如何获得工作表，我们可以开始修改单元格的内容。单元格可以作为工作表的键直接访问:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A4&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>这将返回 A4 单元格，或者如果它还不存在创建一个。值可以直接赋值:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
<p>还有 <code class="xref py py-meth docutils literal notranslate"><span class="pre">Worksheet.cell()</span></code> 方法。</p>
<p>这提供了使用行和列表示法访问单元格</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>在内存中创建工作表时，它不包含 <code class="docutils literal notranslate"><span class="pre">cells</span></code>。它们是在第一次访问时创建的。</p>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>由于这个特性，即使你未对单元格赋值，滚动浏览而非直接访问时也会在内存中直接创建。</p>
<p>可能是</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">):</span>
<span class="gp">... </span>       <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">):</span>
<span class="gp">... </span>           <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>将在内存中创建 100x100 个单元格。</p>
</div>
</section>
<section id="accessing-many-cells">
<h3>访问大量单元格<a class="headerlink" href="#accessing-many-cells" title="永久链接至标题">¶</a></h3>
<p>可以使用切片来访问一系列单元格:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cell_range</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">:</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>一系列的行和列也可以通过类似的方法获取:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">colC</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col_range</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;C:D&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row10</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row_range</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<p>你也使用 <code class="xref py py-meth docutils literal notranslate"><span class="pre">Worksheet.iter_rows()</span></code> 方法:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
<span class="gp">... </span>       <span class="nb">print</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
<span class="go">&lt;Cell Sheet1.A1&gt;</span>
<span class="go">&lt;Cell Sheet1.B1&gt;</span>
<span class="go">&lt;Cell Sheet1.C1&gt;</span>
<span class="go">&lt;Cell Sheet1.A2&gt;</span>
<span class="go">&lt;Cell Sheet1.B2&gt;</span>
<span class="go">&lt;Cell Sheet1.C2&gt;</span>
</pre></div>
</div>
<p>同样 <code class="xref py py-meth docutils literal notranslate"><span class="pre">Worksheet.iter_cols()</span></code> 方法会返回列:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">iter_cols</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
<span class="go">&lt;Cell Sheet1.A1&gt;</span>
<span class="go">&lt;Cell Sheet1.A2&gt;</span>
<span class="go">&lt;Cell Sheet1.B1&gt;</span>
<span class="go">&lt;Cell Sheet1.B2&gt;</span>
<span class="go">&lt;Cell Sheet1.C1&gt;</span>
<span class="go">&lt;Cell Sheet1.C2&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>由于性能原因 <code class="xref py py-obj docutils literal notranslate"><span class="pre">Worksheet.iter_cols()</span></code> 方法在只读模式下不可用。</p>
</div>
<p>如果需要遍历文件中的所有行和列，可以使用 <code class="xref py py-obj docutils literal notranslate"><span class="pre">Worksheet.rows</span></code> 属性:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ws</span><span class="p">[</span><span class="s1">&#39;C9&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hello world&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">tuple</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>
<span class="go">((&lt;Cell Sheet.A1&gt;, &lt;Cell Sheet.B1&gt;, &lt;Cell Sheet.C1&gt;),</span>
<span class="go">(&lt;Cell Sheet.A2&gt;, &lt;Cell Sheet.B2&gt;, &lt;Cell Sheet.C2&gt;),</span>
<span class="go">(&lt;Cell Sheet.A3&gt;, &lt;Cell Sheet.B3&gt;, &lt;Cell Sheet.C3&gt;),</span>
<span class="go">(&lt;Cell Sheet.A4&gt;, &lt;Cell Sheet.B4&gt;, &lt;Cell Sheet.C4&gt;),</span>
<span class="go">(&lt;Cell Sheet.A5&gt;, &lt;Cell Sheet.B5&gt;, &lt;Cell Sheet.C5&gt;),</span>
<span class="go">(&lt;Cell Sheet.A6&gt;, &lt;Cell Sheet.B6&gt;, &lt;Cell Sheet.C6&gt;),</span>
<span class="go">(&lt;Cell Sheet.A7&gt;, &lt;Cell Sheet.B7&gt;, &lt;Cell Sheet.C7&gt;),</span>
<span class="go">(&lt;Cell Sheet.A8&gt;, &lt;Cell Sheet.B8&gt;, &lt;Cell Sheet.C8&gt;),</span>
<span class="go">(&lt;Cell Sheet.A9&gt;, &lt;Cell Sheet.B9&gt;, &lt;Cell Sheet.C9&gt;))</span>
</pre></div>
</div>
<p>或者 <code class="xref py py-obj docutils literal notranslate"><span class="pre">Worksheet.columns</span></code> 属性:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">tuple</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="go">((&lt;Cell Sheet.A1&gt;,</span>
<span class="go">&lt;Cell Sheet.A2&gt;,</span>
<span class="go">&lt;Cell Sheet.A3&gt;,</span>
<span class="go">&lt;Cell Sheet.A4&gt;,</span>
<span class="go">&lt;Cell Sheet.A5&gt;,</span>
<span class="go">&lt;Cell Sheet.A6&gt;,</span>
<span class="gp">...</span>
<span class="go">&lt;Cell Sheet.B7&gt;,</span>
<span class="go">&lt;Cell Sheet.B8&gt;,</span>
<span class="go">&lt;Cell Sheet.B9&gt;),</span>
<span class="go">(&lt;Cell Sheet.C1&gt;,</span>
<span class="go">&lt;Cell Sheet.C2&gt;,</span>
<span class="go">&lt;Cell Sheet.C3&gt;,</span>
<span class="go">&lt;Cell Sheet.C4&gt;,</span>
<span class="go">&lt;Cell Sheet.C5&gt;,</span>
<span class="go">&lt;Cell Sheet.C6&gt;,</span>
<span class="go">&lt;Cell Sheet.C7&gt;,</span>
<span class="go">&lt;Cell Sheet.C8&gt;,</span>
<span class="go">&lt;Cell Sheet.C9&gt;))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>由于性能原因 <code class="xref py py-obj docutils literal notranslate"><span class="pre">Worksheet.columns</span></code> 方法在只读模式下不可用。</p>
</div>
</section>
<section id="values-only">
<h3>Values only<a class="headerlink" href="#values-only" title="永久链接至标题">¶</a></h3>
<p>如果你只想要工作薄的值，你可以使用 <code class="xref py py-obj docutils literal notranslate"><span class="pre">Worksheet.values</span></code> 属性。这会遍历工作簿中所有的行但只返回单元格值:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
   <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
     <span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Worksheet.iter_rows()</span></code> 和 <code class="xref py py-meth docutils literal notranslate"><span class="pre">Worksheet.iter_cols()</span></code> 可以用 <code class="code docutils literal notranslate"><span class="pre">values_only</span></code> 参数来返回单元格值:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">values_only</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

<span class="go">(None, None, None)</span>
<span class="go">(None, None, None)</span>
</pre></div>
</div>
</section>
</section>
<section id="data-storage">
<h2>数据存储<a class="headerlink" href="#data-storage" title="永久链接至标题">¶</a></h2>
<p>一旦有了 <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code>, 我们可以为其分配值:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;hello, world&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="go">&#39;hello, world&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">3.14</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="go">3.14</span>
</pre></div>
</div>
<section id="saving-to-a-file">
<h3>保存至文件<a class="headerlink" href="#saving-to-a-file" title="永久链接至标题">¶</a></h3>
<p>保存工作表最简单和安全的方法就是使用 <code class="xref py py-class docutils literal notranslate"><span class="pre">Workbook</span></code> 类的 <code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook.save()</span></code> 方法:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;balances.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>这个操作将会无警告直接覆盖已有文件。</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>文件名后缀并不强制为 xlsx 或 xlsm，但是如果没使用官方后缀名，会在用其他应用打开时遇到一些麻烦。</p>
<p>由于 OOXML 文件基本上都是 ZIP 文件，你也可以用你喜欢的 ZIP 压缩管理器打开。</p>
</div>
</section>
<section id="saving-as-a-stream">
<h3>保存成流文件<a class="headerlink" href="#saving-as-a-stream" title="永久链接至标题">¶</a></h3>
<p>如果你想把文件保存为流文件，例如当使用 web 应用程序，如 Pyramid，Flask 或 Django 时，你可以简单地提供 <code class="xref py py-func docutils literal notranslate"><span class="pre">NamedTemporaryFile()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">NamedTemporaryFile</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmp</span><span class="p">:</span>
<span class="go">        wb.save(tmp.name)</span>
<span class="go">        tmp.seek(0)</span>
<span class="go">        stream = tmp.read()</span>
</pre></div>
</div>
<p>你可以指定属性 <cite>template=True</cite> 将工作表保存为模板:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;document.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;document_template.xltx&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>或者设置属性为 <code class="docutils literal notranslate"><span class="pre">False</span></code> (默认) 将其保存为文档:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;document_template.xltx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;document.xlsx&#39;</span><span class="p">,</span> <span class="n">as_template</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>你应当在保存模板文档时监视数据的属性和文档拓展名，否则引擎可能会无法打开文档。</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>以下操作将会失败:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;document.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Need to save with the extension *.xlsx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;new_document.xlsm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># MS Excel can&#39;t open the document</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Need specify attribute keep_vba=True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;document.xlsm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;new_document.xlsm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># MS Excel will not open the document</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;document.xltm&#39;</span><span class="p">,</span> <span class="n">keep_vba</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># If we need a template document, then we must specify extension as *.xltm.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;new_document.xlsm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># MS Excel will not open the document</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="loading-from-a-file">
<h2>从文件加载<a class="headerlink" href="#loading-from-a-file" title="永久链接至标题">¶</a></h2>
<p>可以使用 <code class="xref py py-func docutils literal notranslate"><span class="pre">openpyxl.load_workbook()</span></code> 方法来打开已存在的工作表:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">load_workbook</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wb2</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;test.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">wb2</span><span class="o">.</span><span class="n">sheetnames</span><span class="p">)</span>
<span class="go">[&#39;Sheet2&#39;, &#39;New Title&#39;, &#39;Sheet1&#39;]</span>
</pre></div>
</div>
<p>教程到这里就结束了, 你可以继续 <a class="reference internal" href="usage.html"><span class="doc">简单用法</span></a> 部分</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="index.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">教程</a><ul>
<li><a class="reference internal" href="#create-a-workbook">创建工作簿</a></li>
<li><a class="reference internal" href="#playing-with-data">玩数据</a><ul>
<li><a class="reference internal" href="#accessing-one-cell">访问一个单元格</a></li>
<li><a class="reference internal" href="#accessing-many-cells">访问大量单元格</a></li>
<li><a class="reference internal" href="#values-only">Values only</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-storage">数据存储</a><ul>
<li><a class="reference internal" href="#saving-to-a-file">保存至文件</a></li>
<li><a class="reference internal" href="#saving-as-a-stream">保存成流文件</a></li>
</ul>
</li>
<li><a class="reference internal" href="#loading-from-a-file">从文件加载</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一个主题</h4>
    <p class="topless"><a href="index.html"
                          title="上一章">openpyxl - A Python library to read/write Excel 2010 xlsx/xlsm files</a></p>
  </div>
  <div>
    <h4>下一个主题</h4>
    <p class="topless"><a href="usage.html"
                          title="下一章">简单用法</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tutorial.rst.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="usage.html" title="简单用法"
             >下一页</a> |</li>
        <li class="right" >
          <a href="index.html" title="openpyxl - A Python library to read/write Excel 2010 xlsx/xlsm files"
             >上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">openpyxl 3.0.9 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">教程</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; 版权所有 2010 - 2022, See AUTHORS.
      由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0创建。
    </div>
  </body>
</html>